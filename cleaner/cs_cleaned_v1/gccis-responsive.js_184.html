var firstRun = true; var root; $ = jQuery; (function(jQuery) { Drupal.behaviors.myCustomBehavior = { attach: function(context) { jQuery('body').bind('responsivelayout', function(e, d) { if(jQuery(this).hasClass("responsive-layout-normal")){ jQuery('#block-menu-block-1 ul li.expanded &gt; a').unbind('click'); jQuery('#block-menu-block-1 ul li.expanded &gt; a').click(function(e) { return true; }); } }); } }; })(jQuery); jQuery(document).ready(function(){ accordion_link = new Array(); accordion_content = new Array(); jQuery('.accordion-content').each(function(index) { accordion_content.push(this); jQuery(this).hide(); }); jQuery('.accordion-link').each(function(index) { accordion_link.push(this); jQuery(this).click(function() { toggle(index); }); }); function scrollTop() { jQuery('html, body').animate({ scrollTop: 0 }, 500); } jQuery(window).scroll(function(){ var pos = window.pageYOffset; scoller = jQuery(".backtotop") if(pos &gt;= 400) { if(!scoller.hasClass("shown")) { scoller.addClass("shown"); } } else { if(scoller.hasClass("shown")) { scoller.removeClass("shown"); } } }); jQuery(".backtotop").click(function(){scrollTop();}); if($('#views_slideshow_cycle_main_news_navigation-block_1 &gt; *').length &lt;= 1){ $('#block-views-news-navigation-block-1 .views-slideshow-controls-top').hide(); $('#block-views-news-navigation-block-1 .views-slideshow-controls-top *').css('display', 'none','important'); } if ( $( ".accordion" ).length ) { jQuery( ".accordion" ).accordion({ active: false, collapsible: true, heightStyle: "content", change: function (event, ui) { if(ui.newHeader.offset() != null){ jQuery('html, body').animate({scrollTop:ui.newHeader.offset().top},'slow'); } } }); } }); function toggle(number) { target_link = accordion_link[number]; target_content = accordion_content[number]; if (jQuery(target_content).is(":hidden")) { jQuery(target_link).addClass("active"); jQuery(target_content).slideDown("slow"); } else { jQuery(target_link).removeClass("active"); jQuery(target_content).slideUp("slow"); } } (function($){ $(document).ready(function(){ // Used for spotlights var spotlightOffset = $('.spotlights').offset(); var $header = $('.identity-bar'), $menu = $('#block-menu-block-1'), $searchText = $('.identity-right .form-text'), $search = $('.identity-right'), $searchButton = $('#search-button'), $menuButton = $('#menu-button') speed = 'fast', menuSpeed = 350, menuMarginLeft = $menu.css('margin-left'), mobile = $searchButton.is(':visible') &amp;&amp; $menuButton.is(':visible'); if(mobile){mobilizeMenu();} $searchButton.click(function(){ $search.animate({ left: $header.hasClass('open') ? '100%' : 0, marginLeft: $header.hasClass('open') ? '-54px' : 0 }, speed); $header.toggleClass('open'); if($('body').hasClass('mobile-menu-open')){$menuButton.trigger('click')} }); if(jQuery('body').hasClass('front')){ root = jQuery(".homenames-scrollable").scrollable({circular: true}).autoscroll({ autoplay: true }).data('scrollable'); // Call our responsive function responsiveScrollable(); } function responsiveScrollable(){ // Set width of scrollable slides to width of browser window var siteWidth = window.innerWidth; if(siteWidth &gt; 931){siteWidth=931;} $('.homenames-scrollable .carousel-slide').css('width', siteWidth); // Set scrollable height to be proportional to the aspect ratio of the slide's content - eg if in your design the slide is 1000w x 500h, this ratio would be 2 var bannerHeight = $(window).width() / 3.15; $('.homenames-scrollable').css('height', bannerHeight); // Use the api to reposition the slide once it's been resized (if the broswer is resized) //var api = $(".homenames-scrollable").data('scrollable'); if(root != undefined){ var currentSlide = root.getIndex(); root.seekTo(1, 50); } } $(window).resize(function(){ responsiveScrollable(); mobilizeMenu(); mobile = $searchButton.is(':visible') &amp;&amp; $menuButton.is(':visible'); if (!mobile) { $search.removeAttr('style'); $menu.removeAttr('style'); $header.removeClass('open'); $menu.find('.menu').removeAttr('style'); $('body').removeClass('mobile-menu-open'); $('#menu-overlay').removeAttr('style'); } }) function mobilizeMenu(){ if(firstRun){ jQuery('#block-menu-block-1 ul li.expanded &gt; a').click(function(e) { if(mobile){ e.preventDefault(); scollMenu = jQuery(this).parent().find('&gt; ul.menu'); needsScroll =jQuery(this).parent().find('&gt; ul.menu').is(':visible'); jQuery(this).parent().find('&gt; ul.menu').toggleClass('open').slideToggle("slow", function() { // Animation complete. if(!needsScroll){scollMenu.find('li:last').scrollintoview();} }); jQuery(this).siblings('.dropdown_arrow').toggleClass('minus'); } }); jQuery( "#block-menu-block-1 li.expanded a" ).each(function( index ) { if(jQuery(this).parent().hasClass("active-trail")){ jQuery(this).siblings('ul.menu').toggleClass('open').slideToggle(); jQuery(this).siblings('.dropdown_arrow').toggleClass('minus'); } }); jQuery(' 
<span>&nbsp;</span>').insertAfter("li.expanded &gt; ul"); firstRun = false; } } $('#menu-button').click(function(){ var openMenu = $('body').hasClass('mobile-menu-open'); $menu.animate({ left: openMenu ? "-300px" : menuMarginLeft, }, menuSpeed); $('#menu-overlay').fadeToggle(menuSpeed); $('body').toggleClass('mobile-menu-open'); }); $('#menu-overlay').click(function(){ var openMenu = $('body').hasClass('mobile-menu-open'); $menu.animate({ left: openMenu ? "-300px" : menuMarginLeft, }, menuSpeed); $('#menu-overlay').fadeToggle(menuSpeed); $('body').toggleClass('mobile-menu-open'); }); $('#close-search').click(function(){ $search.animate({ left: '100%', marginLeft: '-54px' }, speed); $header.toggleClass('open'); }); /* FAQs */ $('.view-frequently-asked-questions .views-field-title').click(function(){ $(this).siblings('.views-field-body').stop().slideToggle(); $(this).parent('.views-row').toggleClass('open'); }); /* To Top */ var $scroller = $('#totop'); $(window).scroll(function(){ $scroller.toggleClass('shown', window.pageYOffset &gt;= 400); }); $scroller.click(function(){ $('html, body').animate({ scrollTop: 0 }, 'slow'); }); /* Registration */ var $otherPositionInput = $('#position-other'); if (!$('input[name="position"]:checked').length || $('input[name="position"]:checked').val() != 'other') { $otherPositionInput.css('display', 'none'); } $('input[name="position"]').click(function(){ if ($(this).val() == 'other') { $otherPositionInput.show(); } else { $otherPositionInput.hide(); } }); //Enable swiping... if($(".view-facilities-slideshow").is(':visible')){ $(".view-facilities-slideshow").swipe( { //Generic swipe handler for all directions swipe:function(event, direction, distance, duration, fingerCount, fingerData) { //alert("You swiped " + direction ); if(direction == 'left'){ $(this).find('.views-slideshow-controls-text-next').trigger('click') }else if(direction == 'right'){ //alert("You swiped " + direction ); $(this).find('.views-slideshow-controls-text-previous').trigger('click') } }, //Default is 75px, set to 0 for demo so any distance triggers swipe threshold:0 }); } }); })(jQuery);